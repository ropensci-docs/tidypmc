<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tidypmc">
<title>Introduction to tidypmc • tidypmc</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to tidypmc">
<meta property="og:description" content="tidypmc">
<meta property="og:image" content="https://docs.ropensci.org/tidypmc/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">tidypmc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="active nav-item">
  <a class="nav-link" href="../articles/tidypmc.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/pmcftp.html">Parsing Europe PMC FTP files</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/tidypmc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to tidypmc</h1>
                        <h4 data-toc-skip class="author">Chris Stubben</h4>
            
            <h4 data-toc-skip class="date">February 29, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/tidypmc/blob/HEAD/vignettes/tidypmc.Rmd" class="external-link"><code>vignettes/tidypmc.Rmd</code></a></small>
      <div class="d-none name"><code>tidypmc.Rmd</code></div>
    </div>

    
    
<p>The <code>tidypmc</code> package parses XML documents in the Open Access subset of <a href="https://europepmc.org" class="external-link">Pubmed Central</a>. Download the full text using <code>pmc_xml</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/tidypmc">tidypmc</a></span><span class="op">)</span></span>
<span><span class="va">doc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmc_xml.html">pmc_xml</a></span><span class="op">(</span><span class="st">"PMC2231364"</span><span class="op">)</span></span>
<span><span class="va">doc</span></span>
<span><span class="co">#  {xml_document}</span></span>
<span><span class="co">#  &lt;article article-type="research-article" xmlns:xlink="http://www.w3.org/1999/xlink"&gt;</span></span>
<span><span class="co">#  [1] &lt;front&gt;\n  &lt;journal-meta&gt;\n    &lt;journal-id journal-id-type="nlm-ta"&gt;BMC M ...</span></span>
<span><span class="co">#  [2] &lt;body&gt;\n  &lt;sec&gt;\n    &lt;title&gt;Background&lt;/title&gt;\n    &lt;p&gt;&lt;italic&gt;Yersinia p ...</span></span>
<span><span class="co">#  [3] &lt;back&gt;\n  &lt;ack&gt;\n    &lt;sec&gt;\n      &lt;title&gt;Acknowledgements&lt;/title&gt;\n       ...</span></span></code></pre></div>
<p>The package includes five functions to parse the <code>xml_document</code>.</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="83%">
</colgroup>
<thead><tr class="header">
<th align="left">R function</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>pmc_text</code></td>
<td align="left">Split section paragraphs into sentences with full path to subsection titles</td>
</tr>
<tr class="even">
<td align="left"><code>pmc_caption</code></td>
<td align="left">Split figure, table and supplementary material captions into sentences</td>
</tr>
<tr class="odd">
<td align="left"><code>pmc_table</code></td>
<td align="left">Convert table nodes into a list of tibbles</td>
</tr>
<tr class="even">
<td align="left"><code>pmc_reference</code></td>
<td align="left">Format references cited into a tibble</td>
</tr>
<tr class="odd">
<td align="left"><code>pmc_metadata</code></td>
<td align="left">List journal and article metadata in front node</td>
</tr>
</tbody>
</table>
<p><code>pmc_text</code> splits paragraphs into sentences and removes any tables, figures or formulas that are nested within paragraph tags, replaces superscripted references with brackets, adds carets and underscores to other superscripts and subscripts and includes the full path to the subsection title.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmc_text.html">pmc_text</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span>
<span><span class="va">txt</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 194 × 4</span></span></span>
<span><span class="co">#     section    paragraph sentence text                                                               </span></span>
<span><span class="co">#     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                              </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 1</span> Title              1        1 Comparative transcriptomics in Yersinia pestis: a global view of e…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 2</span> Abstract           1        1 Environmental modulation of gene expression in Yersinia pestis is …</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 3</span> Abstract           1        2 Using cDNA microarray technology, we have analyzed the global gene…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 4</span> Abstract           2        1 To provide us with a comprehensive view of environmental modulatio…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 5</span> Abstract           2        2 Almost all known virulence genes of Y. pestis were differentially …</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 6</span> Abstract           2        3 Clustering enabled us to functionally classify co-expressed genes,…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 7</span> Abstract           2        4 Collections of operons were predicted from the microarray data, an…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 8</span> Abstract           2        5 Several regulatory DNA motifs, probably recognized by the regulato…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 9</span> Abstract           3        1 The comparative transcriptomics analysis we present here not only …</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">10</span> Background         1        1 Yersinia pestis is the etiological agent of plague, alternatively …</span></span>
<span><span class="co">#  <span style="color: #949494;"># ℹ 184 more rows</span></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">txt</span>, <span class="va">section</span><span class="op">)</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 21 × 2</span></span></span>
<span><span class="co">#     section                                                  n</span></span>
<span><span class="co">#     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 1</span> Abstract                                                 8</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 2</span> Authors' contributions                                   6</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 3</span> Background                                              20</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 4</span> Conclusion                                               3</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 5</span> Methods; Clustering analysis                             7</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 6</span> Methods; Collection of microarray expression data       17</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 7</span> Methods; Discovery of regulatory DNA motifs              8</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 8</span> Methods; Gel mobility shift analysis of Fur binding     13</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 9</span> Methods; Operon prediction                               5</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">10</span> Methods; Verification of predicted operons by RT-PCR     7</span></span>
<span><span class="co">#  <span style="color: #949494;"># ℹ 11 more rows</span></span></span></code></pre></div>
<p><code>pmc_caption</code> splits figure, table and supplementary material captions into sentences.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cap1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmc_caption.html">pmc_caption</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span>
<span><span class="co">#  Found 5 figures</span></span>
<span><span class="co">#  Found 4 tables</span></span>
<span><span class="co">#  Found 3 supplements</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">cap1</span>, <span class="va">sentence</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 12 × 4</span></span></span>
<span><span class="co">#     tag        label                       sentence text                                             </span></span>
<span><span class="co">#     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                            </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 1</span> figure     Figure 1                           1 Environmental modulation of expression of virule…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 2</span> figure     Figure 2                           1 RT-PCR analysis of potential operons.            </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 3</span> figure     Figure 3                           1 Schematic representation of the clustered microa…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 4</span> figure     Figure 4                           1 Graphical representation of the consensus patter…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 5</span> figure     Figure 5                           1 EMSA analysis of the binding of Fur protein to p…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 6</span> table      Table 1                            1 Stress-responsive operons in Y. pestis predicted…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 7</span> table      Table 2                            1 Classification of the gene members of the cluste…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 8</span> table      Table 3                            1 Motif discovery for the clustering genes         </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 9</span> table      Table 4                            1 Designs for expression profiling of Y. pestis    </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">10</span> supplement Additional file 1 Figure S1        1 Growth curves of Y. pestis strain 201 under diff…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">11</span> supplement Additional file 2 Table S1         1 All the transcriptional changes of 4005 genes of…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">12</span> supplement Additional file 3 Table S2         1 List of oligonucleotide primers used in this stu…</span></span></code></pre></div>
<p><code>pmc_table</code> formats tables by collapsing multiline headers, expanding rowspan and colspan attributes and adding subheadings into a new column.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmc_table.html">pmc_table</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span>
<span><span class="co">#  Parsing 4 tables</span></span>
<span><span class="co">#  Adding footnotes to Table 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tab1</span>, <span class="va">nrow</span><span class="op">)</span></span>
<span><span class="co">#  Table 1 Table 2 Table 3 Table 4 </span></span>
<span><span class="co">#       39      23       4      34</span></span>
<span><span class="va">tab1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 39 × 5</span></span></span>
<span><span class="co">#     subheading                Potential operon (r …¹ `Gene ID` Putative or predicte…² `Reference (s)`</span></span>
<span><span class="co">#     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 1</span> Iron uptake or heme synt… yfeABCD operon* (r &gt; … YPO2439-… Transport/binding che… yfeABCD [54]   </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 2</span> Iron uptake or heme synt… hmuRSTUV operon (r &gt; … YPO0279-… Transport/binding hem… hmuRSTUV [55]  </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 3</span> Iron uptake or heme synt… ysuJIHG* (r &gt; 0.95)    YPO1529-… Iron uptake            -              </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 4</span> Iron uptake or heme synt… sufABCDS* (r &gt; 0.90)   YPO2400-… Iron-regulated Fe-S c… -              </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 5</span> Iron uptake or heme synt… YPO1854-1856* (r &gt; 0.… YPO1854-… Iron uptake or heme s… -              </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 6</span> Sulfur metabolism         tauABCD operon (r &gt; 0… YPO0182-… Transport/binding tau… tauABCD [56]   </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 7</span> Sulfur metabolism         ssuEADCB operon (r &gt; … YPO3623-… Sulphur metabolism     ssu operon [57]</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 8</span> Sulfur metabolism         cys operon (r &gt; 0.92)  YPO3010-… Cysteine synthesis     -              </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 9</span> Sulfur metabolism         YPO1317-1319 (r &gt; 0.9… YPO1317-… Sulfur metabolism?     -              </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">10</span> Sulfur metabolism         YPO4109-4111 (r &gt; 0.9… YPO4109-… Sulfur metabolism?     -              </span></span>
<span><span class="co">#  <span style="color: #949494;"># ℹ 29 more rows</span></span></span>
<span><span class="co">#  <span style="color: #949494;"># ℹ abbreviated names: ¹​`Potential operon (r value)`, ²​`Putative or predicted function`</span></span></span></code></pre></div>
<p>Captions and footnotes are added as attributes.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">tab1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#  $names</span></span>
<span><span class="co">#  [1] "subheading"                     "Potential operon (r value)"    </span></span>
<span><span class="co">#  [3] "Gene ID"                        "Putative or predicted function"</span></span>
<span><span class="co">#  [5] "Reference (s)"                 </span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $row.names</span></span>
<span><span class="co">#   [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32</span></span>
<span><span class="co">#  [33] 33 34 35 36 37 38 39</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $class</span></span>
<span><span class="co">#  [1] "tbl_df"     "tbl"        "data.frame"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $caption</span></span>
<span><span class="co">#  [1] "Stress-responsive operons in Y. pestis predicted from microarray expression data"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $footnotes</span></span>
<span><span class="co">#  [1] "'r' represents the correlation coefficient of adjacent genes; '*' represent the defined operon has the similar expression pattern in two other published microarray datasets [7, 21]; '?' inferred functions of uncharacterized genes; '-' means the corresponding operons have not been experimentally validated in other bacteria."</span></span></code></pre></div>
<p>Use <code>collapse_rows</code> to join column names and cell values in a semi-colon delimited string (and then search using functions in the next section).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/collapse_rows.html">collapse_rows</a></span><span class="op">(</span><span class="va">tab1</span>, na.string<span class="op">=</span><span class="st">"-"</span><span class="op">)</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 100 × 3</span></span></span>
<span><span class="co">#     table     row text                                                                               </span></span>
<span><span class="co">#     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                                              </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 1</span> Table 1     1 subheading=Iron uptake or heme synthesis; Potential operon (r value)=yfeABCD opero…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 2</span> Table 1     2 subheading=Iron uptake or heme synthesis; Potential operon (r value)=hmuRSTUV oper…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 3</span> Table 1     3 subheading=Iron uptake or heme synthesis; Potential operon (r value)=ysuJIHG* (r &gt;…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 4</span> Table 1     4 subheading=Iron uptake or heme synthesis; Potential operon (r value)=sufABCDS* (r …</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 5</span> Table 1     5 subheading=Iron uptake or heme synthesis; Potential operon (r value)=YPO1854-1856*…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 6</span> Table 1     6 subheading=Sulfur metabolism; Potential operon (r value)=tauABCD operon (r &gt; 0.90)…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 7</span> Table 1     7 subheading=Sulfur metabolism; Potential operon (r value)=ssuEADCB operon (r &gt; 0.97…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 8</span> Table 1     8 subheading=Sulfur metabolism; Potential operon (r value)=cys operon (r &gt; 0.92); Ge…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 9</span> Table 1     9 subheading=Sulfur metabolism; Potential operon (r value)=YPO1317-1319 (r &gt; 0.97); …</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">10</span> Table 1    10 subheading=Sulfur metabolism; Potential operon (r value)=YPO4109-4111 (r &gt; 0.90); …</span></span>
<span><span class="co">#  <span style="color: #949494;"># ℹ 90 more rows</span></span></span></code></pre></div>
<p><code>pmc_reference</code> extracts the id, pmid, authors, year, title, journal, volume, pages, and DOIs from reference tags.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ref1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pmc_reference.html">pmc_reference</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span>
<span><span class="co">#  Found 76 citation tags</span></span>
<span><span class="va">ref1</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 76 × 9</span></span></span>
<span><span class="co">#        id pmid     authors                                      year title journal volume pages doi  </span></span>
<span><span class="co">#     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 1</span>     1 8993858  Perry RD, Fetherston JD                      <span style="text-decoration: underline;">1</span>997 Yers… Clin M… 10     35-66 <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 2</span>     2 16053250 Hinnebusch BJ                                <span style="text-decoration: underline;">2</span>005 The … Curr I… 7      197-… <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 3</span>     3 6469352  Straley SC, Harmon PA                        <span style="text-decoration: underline;">1</span>984 Yers… Infect… 45     655-… <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 4</span>     4 15557646 Huang XZ, Lindler LE                         <span style="text-decoration: underline;">2</span>004 The … Infect… 72     7212… 10.1…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 5</span>     5 15721832 Pujol C, Bliska JB                           <span style="text-decoration: underline;">2</span>005 Turn… Clin I… 114    216-… 10.1…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 6</span>     6 12732299 Rhodius VA, LaRossa RA                       <span style="text-decoration: underline;">2</span>003 Uses… Curr O… 6      114-… 10.1…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 7</span>     7 15342600 Motin VL, Georgescu AM, Fitch JP, Gu PP, N…  <span style="text-decoration: underline;">2</span>004 Temp… J Bact… 186    6298… 10.1…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 8</span>     8 15557737 Han Y, Zhou D, Pang X, Song Y, Zhang L, Ba…  <span style="text-decoration: underline;">2</span>004 Micr… Microb… 48     791-… <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 9</span>     9 15777740 Han Y, Zhou D, Pang X, Zhang L, Song Y, To…  <span style="text-decoration: underline;">2</span>005 DNA … Microb… 7      335-… 10.1…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">10</span>    10 15808945 Han Y, Zhou D, Pang X, Zhang L, Song Y, To…  <span style="text-decoration: underline;">2</span>005 Comp… Res Mi… 156    403-… 10.1…</span></span>
<span><span class="co">#  <span style="color: #949494;"># ℹ 66 more rows</span></span></span></code></pre></div>
<p>Finally, <code>pmc_metadata</code> saves journal and article metadata to a list.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pmc_metadata.html">pmc_metadata</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span>
<span><span class="co">#  $PMCID</span></span>
<span><span class="co">#  [1] "PMC2231364"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $Title</span></span>
<span><span class="co">#  [1] "Comparative transcriptomics in Yersinia pestis: a global view of environmental modulation of gene expression"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $Authors</span></span>
<span><span class="co">#  [1] "Yanping Han, Jingfu Qiu, Zhaobiao Guo, He Gao, Yajun Song, Dongsheng Zhou, Ruifu Yang"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $Year</span></span>
<span><span class="co">#  [1] 2007</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $Journal</span></span>
<span><span class="co">#  [1] "BMC Microbiology"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $Volume</span></span>
<span><span class="co">#  [1] "7"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $Pages</span></span>
<span><span class="co">#  [1] "96"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $`Published online`</span></span>
<span><span class="co">#  [1] "2007-10-29"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $`Date received`</span></span>
<span><span class="co">#  [1] "2007-6-2"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $DOI</span></span>
<span><span class="co">#  [1] "10.1186/1471-2180-7-96"</span></span>
<span><span class="co">#  </span></span>
<span><span class="co">#  $Publisher</span></span>
<span><span class="co">#  [1] "BioMed Central"</span></span></code></pre></div>
<div class="section level2">
<h2 id="searching-text">Searching text<a class="anchor" aria-label="anchor" href="#searching-text"></a>
</h2>
<p>There are a few functions to search within the <code>pmc_text</code> or collapsed <code>pmc_table</code> output. <code>separate_text</code> uses the <a href="https://stringr.tidyverse.org/" class="external-link">stringr</a> package to extract any matching regular expression.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/separate_text.html">separate_text</a></span><span class="op">(</span><span class="va">txt</span>, <span class="st">"[ATCGN]{5,}"</span><span class="op">)</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 9 × 5</span></span></span>
<span><span class="co">#    match                 section                                             paragraph sentence text </span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">1</span> ACGCAATCGTTTTCNT      Results and Discussion; Computational discovery of…         2        3 A 16…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">2</span> AAACGTTTNCGT          Results and Discussion; Computational discovery of…         2        4 It i…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">3</span> TGATAATGATTATCATTATCA Results and Discussion; Computational discovery of…         2        5 A 21…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">4</span> GATAATGATAATCATTATC   Results and Discussion; Computational discovery of…         2        6 It i…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">5</span> TGANNNNNNTCAA         Results and Discussion; Computational discovery of…         2        7 A 15…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">6</span> TTGATN                Results and Discussion; Computational discovery of…         2        8 It i…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">7</span> NATCAA                Results and Discussion; Computational discovery of…         2        8 It i…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">8</span> GTTAATTAA             Results and Discussion; Computational discovery of…         3        4 The …</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">9</span> GTTAATTAATGT          Results and Discussion; Computational discovery of…         3        5 An A…</span></span></code></pre></div>
<p>A few wrappers search pre-defined patterns and add an extra step to expand matched ranges. <code>separate_refs</code> matches references within brackets using <code>\\[[0-9, -]+\\]</code> and expands ranges like <code>[7-9]</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/separate_refs.html">separate_refs</a></span><span class="op">(</span><span class="va">txt</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 93 × 6</span></span></span>
<span><span class="co">#        id match section    paragraph sentence text                                                   </span></span>
<span><span class="co">#     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                  </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 1</span>     1 [1]   Background         1        1 Yersinia pestis is the etiological agent of plague, al…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 2</span>     2 [2]   Background         1        3 To produce a transmissible infection, Y. pestis coloni…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 3</span>     3 [3]   Background         1        9 However, a few bacilli are taken up by tissue macropha…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 4</span>     4 [4,5] Background         1       10 Residence in this niche also facilitates the bacteria'…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 5</span>     5 [4,5] Background         1       10 Residence in this niche also facilitates the bacteria'…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 6</span>     6 [6]   Background         2        1 A DNA microarray is able to determine simultaneous cha…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 7</span>     7 [7-9] Background         2        2 We and others have measured the gene expression profil…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 8</span>     8 [7-9] Background         2        2 We and others have measured the gene expression profil…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 9</span>     9 [7-9] Background         2        2 We and others have measured the gene expression profil…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">10</span>    10 [10]  Background         2        2 We and others have measured the gene expression profil…</span></span>
<span><span class="co">#  <span style="color: #949494;"># ℹ 83 more rows</span></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">id</span> <span class="op">==</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 5 × 6</span></span></span>
<span><span class="co">#       id match           section                                             paragraph sentence text </span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">1</span>     8 [7-9]           Background                                                  2        2 We a…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">2</span>     8 [8-13,15]       Background                                                  2        4 In o…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">3</span>     8 [7-13,15,19-21] Results and Discussion                                      2        1 Rece…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">4</span>     8 [7-9]           Results and Discussion; Virulence genes in respons…         3        1 As d…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">5</span>     8 [8-10]          Methods; Collection of microarray expression data           1        6 The …</span></span></code></pre></div>
<p><code>separate_genes</code> expands microbial gene operons like <code>hmsHFRS</code> into four separate genes.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/separate_genes.html">separate_genes</a></span><span class="op">(</span><span class="va">txt</span><span class="op">)</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 103 × 6</span></span></span>
<span><span class="co">#     gene  match   section                                                    paragraph sentence text </span></span>
<span><span class="co">#     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 1</span> purR  PurR    Abstract                                                           2        5 Seve…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 2</span> phoP  PhoP    Background                                                         2        3 We a…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 3</span> ompR  OmpR    Background                                                         2        3 We a…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 4</span> oxyR  OxyR    Background                                                         2        3 We a…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 5</span> csrA  CsrA    Results and Discussion                                             1        3 Afte…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 6</span> slyA  SlyA    Results and Discussion                                             1        3 Afte…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 7</span> phoPQ PhoPQ   Results and Discussion                                             1        3 Afte…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 8</span> hmsH  hmsHFRS Results and Discussion; Virulence genes in response to mu…         3        3 For …</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 9</span> hmsF  hmsHFRS Results and Discussion; Virulence genes in response to mu…         3        3 For …</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">10</span> hmsR  hmsHFRS Results and Discussion; Virulence genes in response to mu…         3        3 For …</span></span>
<span><span class="co">#  <span style="color: #949494;"># ℹ 93 more rows</span></span></span></code></pre></div>
<p>Finally, <code>separate_tags</code> expands locus tag ranges.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/collapse_rows.html">collapse_rows</a></span><span class="op">(</span><span class="va">tab1</span>, na<span class="op">=</span><span class="st">"-"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/separate_tags.html">separate_tags</a></span><span class="op">(</span><span class="st">"YPO"</span><span class="op">)</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 270 × 5</span></span></span>
<span><span class="co">#     id      match        table     row text                                                          </span></span>
<span><span class="co">#     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                         </span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 1</span> YPO2439 YPO2439-2442 Table 1     1 subheading=Iron uptake or heme synthesis; Potential operon (r…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 2</span> YPO2440 YPO2439-2442 Table 1     1 subheading=Iron uptake or heme synthesis; Potential operon (r…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 3</span> YPO2441 YPO2439-2442 Table 1     1 subheading=Iron uptake or heme synthesis; Potential operon (r…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 4</span> YPO2442 YPO2439-2442 Table 1     1 subheading=Iron uptake or heme synthesis; Potential operon (r…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 5</span> YPO0279 YPO0279-0283 Table 1     2 subheading=Iron uptake or heme synthesis; Potential operon (r…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 6</span> YPO0280 YPO0279-0283 Table 1     2 subheading=Iron uptake or heme synthesis; Potential operon (r…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 7</span> YPO0281 YPO0279-0283 Table 1     2 subheading=Iron uptake or heme synthesis; Potential operon (r…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 8</span> YPO0282 YPO0279-0283 Table 1     2 subheading=Iron uptake or heme synthesis; Potential operon (r…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 9</span> YPO0283 YPO0279-0283 Table 1     2 subheading=Iron uptake or heme synthesis; Potential operon (r…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">10</span> YPO1529 YPO1529-1532 Table 1     3 subheading=Iron uptake or heme synthesis; Potential operon (r…</span></span>
<span><span class="co">#  <span style="color: #949494;"># ℹ 260 more rows</span></span></span></code></pre></div>
<div class="section level3">
<h3 id="using-xml2">Using <code>xml2</code><a class="anchor" aria-label="anchor" href="#using-xml2"></a>
</h3>
<p>The <code>pmc_*</code> functions use the <a href="https://github.com/r-lib/xml2" class="external-link">xml2</a> package for parsing and may fail in some situations, so it helps to know how to parse <code>xml_documents</code>. Use <code>cat</code> and <code>as.character</code> to view nodes returned by <code>xml_find_all</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xml2.r-lib.org/" class="external-link">xml2</a></span><span class="op">)</span></span>
<span><span class="va">refs</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html" class="external-link">xml_find_all</a></span><span class="op">(</span><span class="va">doc</span>, <span class="st">"//ref"</span><span class="op">)</span></span>
<span><span class="va">refs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#  {xml_nodeset (1)}</span></span>
<span><span class="co">#  [1] &lt;ref id="B1"&gt;\n  &lt;citation citation-type="journal"&gt;\n    &lt;person-group person-group-type="aut ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">refs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#  &lt;ref id="B1"&gt;</span></span>
<span><span class="co">#    &lt;citation citation-type="journal"&gt;</span></span>
<span><span class="co">#      &lt;person-group person-group-type="author"&gt;</span></span>
<span><span class="co">#        &lt;name&gt;</span></span>
<span><span class="co">#          &lt;surname&gt;Perry&lt;/surname&gt;</span></span>
<span><span class="co">#          &lt;given-names&gt;RD&lt;/given-names&gt;</span></span>
<span><span class="co">#        &lt;/name&gt;</span></span>
<span><span class="co">#        &lt;name&gt;</span></span>
<span><span class="co">#          &lt;surname&gt;Fetherston&lt;/surname&gt;</span></span>
<span><span class="co">#          &lt;given-names&gt;JD&lt;/given-names&gt;</span></span>
<span><span class="co">#        &lt;/name&gt;</span></span>
<span><span class="co">#      &lt;/person-group&gt;</span></span>
<span><span class="co">#      &lt;article-title&gt;Yersinia pestis--etiologic agent of plague&lt;/article-title&gt;</span></span>
<span><span class="co">#      &lt;source&gt;Clin Microbiol Rev&lt;/source&gt;</span></span>
<span><span class="co">#      &lt;year&gt;1997&lt;/year&gt;</span></span>
<span><span class="co">#      &lt;volume&gt;10&lt;/volume&gt;</span></span>
<span><span class="co">#      &lt;fpage&gt;35&lt;/fpage&gt;</span></span>
<span><span class="co">#      &lt;lpage&gt;66&lt;/lpage&gt;</span></span>
<span><span class="co">#      &lt;pub-id pub-id-type="pmid"&gt;8993858&lt;/pub-id&gt;</span></span>
<span><span class="co">#    &lt;/citation&gt;</span></span>
<span><span class="co">#  &lt;/ref&gt;</span></span></code></pre></div>
<p>Many journals use superscripts for references cited so they usually appear after words like <code>results9</code> below.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># doc1 &lt;- pmc_xml("PMC6385181")</span></span>
<span><span class="va">doc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html" class="external-link">read_xml</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/PMC6385181.xml"</span>, package <span class="op">=</span> <span class="st">"tidypmc"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".*\\. "</span>, <span class="st">""</span>, <span class="fu"><a href="http://xml2.r-lib.org/reference/xml_text.html" class="external-link">xml_text</a></span><span class="op">(</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html" class="external-link">xml_find_all</a></span><span class="op">(</span><span class="va">doc1</span>, <span class="st">"//sec/p"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#  [1] "RNA-seq identifies the most relevant genes and RT-qPCR validates its results9, especially in the field of environmental and host adaptation10,11 and antimicrobial response12."</span></span></code></pre></div>
<p>Find the tags using <code>xml_find_all</code> and then update the nodes by adding brackets or other text.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bib</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html" class="external-link">xml_find_all</a></span><span class="op">(</span><span class="va">doc1</span>, <span class="st">"//xref[@ref-type='bibr']"</span><span class="op">)</span></span>
<span><span class="va">bib</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#  {xml_nodeset (1)}</span></span>
<span><span class="co">#  [1] &lt;xref ref-type="bibr" rid="CR1"&gt;1&lt;/xref&gt;</span></span>
<span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_text.html" class="external-link">xml_text</a></span><span class="op">(</span><span class="va">bib</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">" ["</span>, <span class="fu"><a href="http://xml2.r-lib.org/reference/xml_text.html" class="external-link">xml_text</a></span><span class="op">(</span><span class="va">bib</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span></span>
<span><span class="va">bib</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#  {xml_nodeset (1)}</span></span>
<span><span class="co">#  [1] &lt;xref ref-type="bibr" rid="CR1"&gt; [1]&lt;/xref&gt;</span></span></code></pre></div>
<p>The text is now separated from the reference. Note the <code>pmc_text</code> function adds the brackets by default.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".*\\. "</span>, <span class="st">""</span>, <span class="fu"><a href="http://xml2.r-lib.org/reference/xml_text.html" class="external-link">xml_text</a></span><span class="op">(</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html" class="external-link">xml_find_all</a></span><span class="op">(</span><span class="va">doc1</span>, <span class="st">"//sec/p"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#  [1] "RNA-seq identifies the most relevant genes and RT-qPCR validates its results [9], especially in the field of environmental and host adaptation [10], [11] and antimicrobial response [12]."</span></span></code></pre></div>
<p>Genes, species and many other terms are often included within italic tags. You can mark these nodes using the same code above or simply list all the names in italics and search text or tables for matches, for example three letter gene names in text below.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/xml_name.html" class="external-link">xml_name</a></span><span class="op">(</span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html" class="external-link">xml_find_all</a></span><span class="op">(</span><span class="va">doc</span>, <span class="st">"//*"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>tag<span class="op">=</span><span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">tag</span>, sort<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 84 × 2</span></span></span>
<span><span class="co">#     tag               n</span></span>
<span><span class="co">#     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 1</span> td              398</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 2</span> given-names     388</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 3</span> name            388</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 4</span> surname         388</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 5</span> italic          235</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 6</span> pub-id          129</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 7</span> tr              117</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 8</span> xref            108</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 9</span> year             80</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">10</span> article-title    77</span></span>
<span><span class="co">#  <span style="color: #949494;"># ℹ 74 more rows</span></span></span>
<span><span class="va">it</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/xml_text.html" class="external-link">xml_text</a></span><span class="op">(</span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html" class="external-link">xml_find_all</a></span><span class="op">(</span><span class="va">doc</span>, <span class="st">"//sec//p//italic"</span><span class="op">)</span>, trim<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">it2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>italic<span class="op">=</span><span class="va">it</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">italic</span>, sort<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">it2</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 53 × 2</span></span></span>
<span><span class="co">#     italic              n</span></span>
<span><span class="co">#     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 1</span> Y. pestis          46</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 2</span> in vitro            5</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 3</span> E. coli             4</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 4</span> psaEFABC            3</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 5</span> r                   3</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 6</span> Yersinia            2</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 7</span> Yersinia pestis     2</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 8</span> cis                 2</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;"> 9</span> fur                 2</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">10</span> n                   2</span></span>
<span><span class="co">#  <span style="color: #949494;"># ℹ 43 more rows</span></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">it2</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">italic</span><span class="op">)</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 8 × 2</span></span></span>
<span><span class="co">#    italic     n</span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">1</span> cis        2</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">2</span> fur        2</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">3</span> cys        1</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">4</span> hmu        1</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">5</span> ybt        1</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">6</span> yfe        1</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">7</span> yfu        1</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">8</span> ymt        1</span></span>
<span><span class="fu"><a href="../reference/separate_text.html">separate_text</a></span><span class="op">(</span><span class="va">txt</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fur"</span>, <span class="st">"cys"</span>, <span class="st">"hmu"</span>, <span class="st">"ybt"</span>, <span class="st">"yfe"</span>, <span class="st">"yfu"</span>, <span class="st">"ymt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#  <span style="color: #949494;"># A tibble: 9 × 5</span></span></span>
<span><span class="co">#    match section                                                             paragraph sentence text </span></span>
<span><span class="co">#    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">1</span> ymt   Results and Discussion; Virulence genes in response to multiple en…         3        4 The …</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">2</span> fur   Results and Discussion; Clustering analysis and functional classif…         3        2 It i…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">3</span> yfe   Results and Discussion; Clustering analysis and functional classif…         3        4 Gene…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">4</span> hmu   Results and Discussion; Clustering analysis and functional classif…         3        4 Gene…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">5</span> yfu   Results and Discussion; Clustering analysis and functional classif…         3        4 Gene…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">6</span> ybt   Results and Discussion; Clustering analysis and functional classif…         3        4 Gene…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">7</span> cys   Results and Discussion; Clustering analysis and functional classif…         4        2 Gene…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">8</span> cys   Results and Discussion; Clustering analysis and functional classif…         4        3 Clus…</span></span>
<span><span class="co">#  <span style="color: #BCBCBC;">9</span> fur   Methods; Gel mobility shift analysis of Fur binding                         1        1 The …</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
