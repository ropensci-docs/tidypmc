<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Parse XML documents from the Open Access subset of Europe PubMed Central &lt;https://europepmc.org&gt;
    including section paragraphs, tables, captions and references.">
<title>Parse Full Text XML Documents from PubMed Central â€¢ tidypmc</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Parse Full Text XML Documents from PubMed Central">
<meta property="og:description" content="Parse XML documents from the Open Access subset of Europe PubMed Central &lt;https://europepmc.org&gt;
    including section paragraphs, tables, captions and references.">
<meta property="og:image" content="https://docs.ropensci.org/tidypmc/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="index.html">tidypmc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="articles/tidypmc.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/pmcftp.html">Parsing Europe PMC FTP files</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/tidypmc/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="tidypmc">tidypmc<a class="anchor" aria-label="anchor" href="#tidypmc"></a>
</h1>
</div>
<p>The <a href="https://europepmc.org/downloads/openaccess" class="external-link">Open Access subset</a> of <a href="https://europepmc.org" class="external-link">Pubmed Central</a> (PMC) includes 2.5 million articles from biomedical and life sciences journals. The full text XML files are freely available for text mining from the <a href="https://europepmc.org/RestfulWebService" class="external-link">REST service</a> or <a href="https://europepmc.org/ftp/oa/" class="external-link">FTP site</a> but can be challenging to parse. For example, section tags are nested to arbitrary depths, formulas and tables may return incomprehensible text blobs and superscripted references are pasted at the end of words. The functions in the <code>tidypmc</code> package are intended to return readable text and maintain the document structure, so gene names and other terms can be associated with specific sections, paragraphs, sentences or table rows.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Use <a href="https://github.com/r-lib/remotes" class="external-link">remotes</a> to install the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"ropensci/tidypmc"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-xml">Load XML<a class="anchor" aria-label="anchor" href="#load-xml"></a>
</h2>
<p>Download a single XML document like <a href="https://www.ebi.ac.uk/europepmc/webservices/rest/PMC2231364/fullTextXML" class="external-link">PMC2231364</a> from the <a href="https://europepmc.org/RestfulWebService" class="external-link">REST service</a> using the <code>pmc_xml</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/tidypmc">tidypmc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">doc</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pmc_xml.html">pmc_xml</a></span><span class="op">(</span><span class="st">"PMC2231364"</span><span class="op">)</span></span>
<span><span class="va">doc</span></span>
<span><span class="co">#  {xml_document}</span></span>
<span><span class="co">#  &lt;article article-type="research-article" xmlns:xlink="http://www.w3.org/1999/xlink"&gt;</span></span>
<span><span class="co">#  [1] &lt;front&gt;\n  &lt;journal-meta&gt;\n    &lt;journal-id journal-id-type="nlm-ta"&gt;BMC Microbiol&lt;/journal-id ...</span></span>
<span><span class="co">#  [2] &lt;body&gt;\n  &lt;sec&gt;\n    &lt;title&gt;Background&lt;/title&gt;\n    &lt;p&gt;&lt;italic&gt;Yersinia pestis &lt;/italic&gt;is th ...</span></span>
<span><span class="co">#  [3] &lt;back&gt;\n  &lt;ack&gt;\n    &lt;sec&gt;\n      &lt;title&gt;Acknowledgements&lt;/title&gt;\n      &lt;p&gt;We thank Dr. Chen ...</span></span></code></pre></div>
<p>The <a href="https://github.com/ropensci/europepmc" class="external-link">europepmc</a> package includes additional functions to search PMC and download full text. Be sure to include the <code>OPEN_ACCESS</code> field in the search since these are the only articles with full text XML available.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/europepmc/" class="external-link">europepmc</a></span><span class="op">)</span></span>
<span><span class="va">yp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/europepmc/reference/epmc_search.html" class="external-link">epmc_search</a></span><span class="op">(</span><span class="st">"title:(Yersinia pestis virulence) OPEN_ACCESS:Y"</span><span class="op">)</span></span>
<span><span class="co">#  19 records found, returning 19</span></span>
<span><span class="fu">select</span><span class="op">(</span><span class="va">yp</span>, <span class="va">pmcid</span>, <span class="va">pubYear</span>, <span class="va">title</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#  # A tibble: 19 x 3</span></span>
<span><span class="co">#    pmcid      pubYear title                                                                          </span></span>
<span><span class="co">#    &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt;                                                                          </span></span>
<span><span class="co">#  1 PMC5505154 2017    Crystal structure of Yersinia pestis virulence factor YfeA reveals two polyspeâ€¦</span></span>
<span><span class="co">#  2 PMC3521224 2012    Omics strategies for revealing Yersinia pestis virulence.                      </span></span>
<span><span class="co">#  3 PMC2704395 2009    Involvement of the post-transcriptional regulator Hfq in Yersinia pestis virulâ€¦</span></span>
<span><span class="co">#  4 PMC2736372 2009    The NlpD lipoprotein is a novel Yersinia pestis virulence factor essential forâ€¦</span></span>
<span><span class="co">#  5 PMC3109262 2011    A comprehensive study on the role of the Yersinia pestis virulence markers in â€¦</span></span>
<span><span class="co">#  # â€¦ with 14 more rows</span></span></code></pre></div>
<p>Save all 19 results to a list of XML documents using the <code>epmc_ftxt</code> or <code>pmc_xml</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">docs</span> <span class="op">&lt;-</span> <span class="fu">map</span><span class="op">(</span><span class="va">yp</span><span class="op">$</span><span class="va">pmcid</span>, <span class="va">epmc_ftxt</span><span class="op">)</span></span></code></pre></div>
<p>See the <a href="https://github.com/ropensci/tidypmc/blob/master/vignettes/pmcftp.md" class="external-link">PMC FTP vignette</a> for details on parsing the large XML files on the <a href="https://europepmc.org/ftp/oa/" class="external-link">FTP site</a> with 10,000 articles each.</p>
</div>
<div class="section level2">
<h2 id="parse-xml">Parse XML<a class="anchor" aria-label="anchor" href="#parse-xml"></a>
</h2>
<p>The package includes five functions to parse the <code>xml_document</code>.</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="83%">
</colgroup>
<thead><tr class="header">
<th align="left">R function</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>pmc_text</code></td>
<td align="left">Split section paragraphs into sentences with full path to subsection titles</td>
</tr>
<tr class="even">
<td align="left"><code>pmc_caption</code></td>
<td align="left">Split figure, table and supplementary material captions into sentences</td>
</tr>
<tr class="odd">
<td align="left"><code>pmc_table</code></td>
<td align="left">Convert table nodes into a list of tibbles</td>
</tr>
<tr class="even">
<td align="left"><code>pmc_reference</code></td>
<td align="left">Format references cited into a tibble</td>
</tr>
<tr class="odd">
<td align="left"><code>pmc_metadata</code></td>
<td align="left">List journal and article metadata in front node</td>
</tr>
</tbody>
</table>
<p>The <code>pmc_text</code> function uses the <a href="https://lincolnmullen.com/software/tokenizers/" class="external-link">tokenizers</a> package to split section paragraphs into sentences. The function also removes any tables, figures or formulas that are nested within paragraph tags, replaces superscripted references with brackets, adds carets and underscores to other superscripts and subscripts and includes the full path to the subsection title.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pmc_text.html">pmc_text</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span>
<span><span class="co">#  Note: removing disp-formula nested in sec/p tag</span></span>
<span><span class="va">txt</span></span>
<span><span class="co">#  # A tibble: 194 x 4</span></span>
<span><span class="co">#     section    paragraph sentence text                                                                         </span></span>
<span><span class="co">#     &lt;chr&gt;          &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                                                                        </span></span>
<span><span class="co">#   1 Title              1        1 Comparative transcriptomics in Yersinia pestis: a global view of environmentâ€¦</span></span>
<span><span class="co">#   2 Abstract           1        1 Environmental modulation of gene expression in Yersinia pestis is critical fâ€¦</span></span>
<span><span class="co">#   3 Abstract           1        2 Using cDNA microarray technology, we have analyzed the global gene expressioâ€¦</span></span>
<span><span class="co">#   4 Abstract           2        1 To provide us with a comprehensive view of environmental modulation of globaâ€¦</span></span>
<span><span class="co">#   5 Abstract           2        2 Almost all known virulence genes of Y. pestis were differentially regulated â€¦</span></span>
<span><span class="co">#   6 Abstract           2        3 Clustering enabled us to functionally classify co-expressed genes, includingâ€¦</span></span>
<span><span class="co">#   7 Abstract           2        4 Collections of operons were predicted from the microarray data, and some of â€¦</span></span>
<span><span class="co">#   8 Abstract           2        5 Several regulatory DNA motifs, probably recognized by the regulatory proteinâ€¦</span></span>
<span><span class="co">#   9 Abstract           3        1 The comparative transcriptomics analysis we present here not only benefits oâ€¦</span></span>
<span><span class="co">#  10 Background         1        1 Yersinia pestis is the etiological agent of plague, alternatively growing inâ€¦</span></span>
<span><span class="co">#  # â€¦ with 184 more rows</span></span>
<span><span class="fu">count</span><span class="op">(</span><span class="va">txt</span>, <span class="va">section</span>, sort<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#  # A tibble: 21 x 2</span></span>
<span><span class="co">#     section                                                                                                   n</span></span>
<span><span class="co">#     &lt;chr&gt;                                                                                                 &lt;int&gt;</span></span>
<span><span class="co">#   1 Results and Discussion; Clustering analysis and functional classification of co-expressed gene clustâ€¦    22</span></span>
<span><span class="co">#   2 Background                                                                                               20</span></span>
<span><span class="co">#   3 Results and Discussion; Virulence genes in response to multiple environmental stresses                   20</span></span>
<span><span class="co">#   4 Methods; Collection of microarray expression data                                                        17</span></span>
<span><span class="co">#   5 Results and Discussion; Computational discovery of regulatory DNA motifs                                 16</span></span>
<span><span class="co">#   6 Methods; Gel mobility shift analysis of Fur binding                                                      13</span></span>
<span><span class="co">#   7 Results and Discussion; Verification of predicted operons by RT-PCR                                      10</span></span>
<span><span class="co">#   8 Abstract                                                                                                  8</span></span>
<span><span class="co">#   9 Methods; Discovery of regulatory DNA motifs                                                               8</span></span>
<span><span class="co">#  10 Methods; Clustering analysis                                                                              7</span></span>
<span><span class="co">#  # â€¦ with 11 more rows</span></span></code></pre></div>
<p>Load the <a href="https://www.tidytextmining.com/" class="external-link">tidytext</a> package for further text processing.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/juliasilge/tidytext" class="external-link">tidytext</a></span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tidytext/man/unnest_tokens.html" class="external-link">unnest_tokens</a></span><span class="op">(</span><span class="va">txt</span>, <span class="va">word</span>, <span class="va">text</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">anti_join</span><span class="op">(</span><span class="va">stop_words</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="va">word</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#  Joining, by = "word"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fu">str_detect</span><span class="op">(</span><span class="va">section</span>, <span class="st">"^Results"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#  # A tibble: 1,269 x 4</span></span>
<span><span class="co">#     section                paragraph sentence word         </span></span>
<span><span class="co">#     &lt;chr&gt;                      &lt;int&gt;    &lt;int&gt; &lt;chr&gt;        </span></span>
<span><span class="co">#   1 Results and Discussion         1        1 comprehensive</span></span>
<span><span class="co">#   2 Results and Discussion         1        1 analysis     </span></span>
<span><span class="co">#   3 Results and Discussion         1        1 sets         </span></span>
<span><span class="co">#   4 Results and Discussion         1        1 microarray   </span></span>
<span><span class="co">#   5 Results and Discussion         1        1 expression   </span></span>
<span><span class="co">#   6 Results and Discussion         1        1 data         </span></span>
<span><span class="co">#   7 Results and Discussion         1        1 dissect      </span></span>
<span><span class="co">#   8 Results and Discussion         1        1 bacterial    </span></span>
<span><span class="co">#   9 Results and Discussion         1        1 adaptation   </span></span>
<span><span class="co">#  10 Results and Discussion         1        1 environments </span></span>
<span><span class="co">#  # â€¦ with 1,259 more rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fu">str_detect</span><span class="op">(</span><span class="va">section</span>, <span class="st">"^Results"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">word</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#  # A tibble: 595 x 2</span></span>
<span><span class="co">#     word           n</span></span>
<span><span class="co">#     &lt;chr&gt;      &lt;int&gt;</span></span>
<span><span class="co">#   1 genes         45</span></span>
<span><span class="co">#   2 cluster       24</span></span>
<span><span class="co">#   3 expression    21</span></span>
<span><span class="co">#   4 pestis        21</span></span>
<span><span class="co">#   5 data          19</span></span>
<span><span class="co">#   6 dna           15</span></span>
<span><span class="co">#   7 gene          15</span></span>
<span><span class="co">#   8 figure        13</span></span>
<span><span class="co">#   9 fur           12</span></span>
<span><span class="co">#  10 operons       12</span></span>
<span><span class="co">#  # â€¦ with 585 more rows</span></span></code></pre></div>
<p>The <code>pmc_table</code> function formats tables by collapsing multiline headers, expanding rowspan and colspan attributes and adding subheadings into a new column.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbls</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/pmc_table.html">pmc_table</a></span><span class="op">(</span><span class="va">doc</span><span class="op">)</span></span>
<span><span class="co">#  Parsing 4 tables</span></span>
<span><span class="co">#  Adding footnotes to Table 1</span></span>
<span><span class="fu">map_int</span><span class="op">(</span><span class="va">tbls</span>, <span class="va">nrow</span><span class="op">)</span></span>
<span><span class="co">#  Table 1 Table 2 Table 3 Table 4 </span></span>
<span><span class="co">#       39      23       4      34</span></span>
<span><span class="va">tbls</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#  # A tibble: 39 x 5</span></span>
<span><span class="co">#     subheading              `Potential operon (r vaâ€¦ `Gene ID`   `Putative or predicted functiâ€¦ `Reference (s)`</span></span>
<span><span class="co">#     &lt;chr&gt;                   &lt;chr&gt;                    &lt;chr&gt;       &lt;chr&gt;                          &lt;chr&gt;          </span></span>
<span><span class="co">#   1 Iron uptake or heme syâ€¦ yfeABCD operon* (r &gt; 0.â€¦ YPO2439-24â€¦ Transport/binding chelated irâ€¦ yfeABCD [54]   </span></span>
<span><span class="co">#   2 Iron uptake or heme syâ€¦ hmuRSTUV operon (r &gt; 0.â€¦ YPO0279-02â€¦ Transport/binding hemin        hmuRSTUV [55]  </span></span>
<span><span class="co">#   3 Iron uptake or heme syâ€¦ ysuJIHG* (r &gt; 0.95)      YPO1529-15â€¦ Iron uptake                    -              </span></span>
<span><span class="co">#   4 Iron uptake or heme syâ€¦ sufABCDS* (r &gt; 0.90)     YPO2400-24â€¦ Iron-regulated Fe-S cluster aâ€¦ -              </span></span>
<span><span class="co">#   5 Iron uptake or heme syâ€¦ YPO1854-1856* (r &gt; 0.97) YPO1854-18â€¦ Iron uptake or heme synthesis? -              </span></span>
<span><span class="co">#   6 Sulfur metabolism       tauABCD operon (r &gt; 0.9â€¦ YPO0182-01â€¦ Transport/binding taurine      tauABCD [56]   </span></span>
<span><span class="co">#   7 Sulfur metabolism       ssuEADCB operon (r &gt; 0.â€¦ YPO3623-36â€¦ Sulphur metabolism             ssu operon [57]</span></span>
<span><span class="co">#   8 Sulfur metabolism       cys operon (r &gt; 0.92)    YPO3010-30â€¦ Cysteine synthesis             -              </span></span>
<span><span class="co">#   9 Sulfur metabolism       YPO1317-1319 (r &gt; 0.97)  YPO1317-13â€¦ Sulfur metabolism?             -              </span></span>
<span><span class="co">#  10 Sulfur metabolism       YPO4109-4111 (r &gt; 0.90)  YPO4109-41â€¦ Sulfur metabolism?             -              </span></span>
<span><span class="co">#  # â€¦ with 29 more rows</span></span></code></pre></div>
<p>Use <code>collapse_rows</code> to join column names and cell values in a semi-colon delimited string (and then search using functions in the next section).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/collapse_rows.html">collapse_rows</a></span><span class="op">(</span><span class="va">tbls</span>, na.string<span class="op">=</span><span class="st">"-"</span><span class="op">)</span></span>
<span><span class="co">#  # A tibble: 100 x 3</span></span>
<span><span class="co">#     table     row text                                                                                         </span></span>
<span><span class="co">#     &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;                                                                                        </span></span>
<span><span class="co">#   1 Table 1     1 subheading=Iron uptake or heme synthesis; Potential operon (r value)=yfeABCD operon* (r &gt; 0.â€¦</span></span>
<span><span class="co">#   2 Table 1     2 subheading=Iron uptake or heme synthesis; Potential operon (r value)=hmuRSTUV operon (r &gt; 0.â€¦</span></span>
<span><span class="co">#   3 Table 1     3 subheading=Iron uptake or heme synthesis; Potential operon (r value)=ysuJIHG* (r &gt; 0.95); Geâ€¦</span></span>
<span><span class="co">#   4 Table 1     4 subheading=Iron uptake or heme synthesis; Potential operon (r value)=sufABCDS* (r &gt; 0.90); Gâ€¦</span></span>
<span><span class="co">#   5 Table 1     5 subheading=Iron uptake or heme synthesis; Potential operon (r value)=YPO1854-1856* (r &gt; 0.97â€¦</span></span>
<span><span class="co">#   6 Table 1     6 subheading=Sulfur metabolism; Potential operon (r value)=tauABCD operon (r &gt; 0.90); Gene ID=â€¦</span></span>
<span><span class="co">#   7 Table 1     7 subheading=Sulfur metabolism; Potential operon (r value)=ssuEADCB operon (r &gt; 0.97); Gene IDâ€¦</span></span>
<span><span class="co">#   8 Table 1     8 subheading=Sulfur metabolism; Potential operon (r value)=cys operon (r &gt; 0.92); Gene ID=YPO3â€¦</span></span>
<span><span class="co">#   9 Table 1     9 subheading=Sulfur metabolism; Potential operon (r value)=YPO1317-1319 (r &gt; 0.97); Gene ID=YPâ€¦</span></span>
<span><span class="co">#  10 Table 1    10 subheading=Sulfur metabolism; Potential operon (r value)=YPO4109-4111 (r &gt; 0.90); Gene ID=YPâ€¦</span></span>
<span><span class="co">#  # â€¦ with 90 more rows</span></span></code></pre></div>
<p>The other three <code>pmc</code> functions are described in the package <a href="https://github.com/ropensci/tidypmc/blob/master/vignettes/tidypmc.md" class="external-link">vignette</a>.</p>
</div>
<div class="section level2">
<h2 id="searching-text">Searching text<a class="anchor" aria-label="anchor" href="#searching-text"></a>
</h2>
<p>There are a few functions to search within the <code>pmc_text</code> or collapsed <code>pmc_table</code> output. <code>separate_text</code> uses the <a href="https://stringr.tidyverse.org/" class="external-link">stringr</a> package to extract any regular expression or vector of words.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/separate_text.html">separate_text</a></span><span class="op">(</span><span class="va">txt</span>, <span class="st">"[ATCGN]{5,}"</span><span class="op">)</span></span>
<span><span class="co">#  # A tibble: 9 x 5</span></span>
<span><span class="co">#    match        section                         paragraph sentence text                                        </span></span>
<span><span class="co">#    &lt;chr&gt;        &lt;chr&gt;                               &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                                       </span></span>
<span><span class="co">#  1 ACGCAATCGTTâ€¦ Results and Discussion; Computâ€¦         2        3 A 16 basepair (bp) box (5'-ACGCAATCGTTTTCNTâ€¦</span></span>
<span><span class="co">#  2 AAACGTTTNCGT Results and Discussion; Computâ€¦         2        4 It is very similar to the E. coli PurR box â€¦</span></span>
<span><span class="co">#  3 TGATAATGATTâ€¦ Results and Discussion; Computâ€¦         2        5 A 21 bp box (5'-TGATAATGATTATCATTATCA-3') wâ€¦</span></span>
<span><span class="co">#  4 GATAATGATAAâ€¦ Results and Discussion; Computâ€¦         2        6 It is a 10-1-10 inverted repeat that resembâ€¦</span></span>
<span><span class="co">#  5 TGANNNNNNTCâ€¦ Results and Discussion; Computâ€¦         2        7 A 15 bp box (5'-TGANNNNNNTCAA-3') was foundâ€¦</span></span>
<span><span class="co">#  6 TTGATN       Results and Discussion; Computâ€¦         2        8 It is a part of the E. coli Fnr box (5'-AAWâ€¦</span></span>
<span><span class="co">#  7 NATCAA       Results and Discussion; Computâ€¦         2        8 It is a part of the E. coli Fnr box (5'-AAWâ€¦</span></span>
<span><span class="co">#  8 GTTAATTAA    Results and Discussion; Computâ€¦         3        4 The ArcA regulator can recognize a relativeâ€¦</span></span>
<span><span class="co">#  9 GTTAATTAATGT Results and Discussion; Computâ€¦         3        5 An ArcA-box-like sequence (5'-GTTAATTAATGT-â€¦</span></span></code></pre></div>
<p>A few wrappers search pre-defined patterns and add an extra step to expand matched ranges. <code>separate_refs</code> matches references within brackets using <code>\\[[0-9, -]+\\]</code> and expands ranges like <code>[7-9]</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/separate_refs.html">separate_refs</a></span><span class="op">(</span><span class="va">txt</span><span class="op">)</span></span>
<span><span class="co">#  # A tibble: 93 x 6</span></span>
<span><span class="co">#        id match section   paragraph sentence text                                                              </span></span>
<span><span class="co">#     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;         &lt;int&gt;    &lt;int&gt; &lt;chr&gt;                                                             </span></span>
<span><span class="co">#   1     1 [1]   Backgrouâ€¦         1        1 Yersinia pestis is the etiological agent of plague, alternativelyâ€¦</span></span>
<span><span class="co">#   2     2 [2]   Backgrouâ€¦         1        3 To produce a transmissible infection, Y. pestis colonizes the fleâ€¦</span></span>
<span><span class="co">#   3     3 [3]   Backgrouâ€¦         1        9 However, a few bacilli are taken up by tissue macrophages, providâ€¦</span></span>
<span><span class="co">#   4     4 [4,5] Backgrouâ€¦         1       10 Residence in this niche also facilitates the bacteria's resistancâ€¦</span></span>
<span><span class="co">#   5     5 [4,5] Backgrouâ€¦         1       10 Residence in this niche also facilitates the bacteria's resistancâ€¦</span></span>
<span><span class="co">#   6     6 [6]   Backgrouâ€¦         2        1 A DNA microarray is able to determine simultaneous changes in allâ€¦</span></span>
<span><span class="co">#   7     7 [7-9] Backgrouâ€¦         2        2 We and others have measured the gene expression profiles of Y. peâ€¦</span></span>
<span><span class="co">#   8     8 [7-9] Backgrouâ€¦         2        2 We and others have measured the gene expression profiles of Y. peâ€¦</span></span>
<span><span class="co">#   9     9 [7-9] Backgrouâ€¦         2        2 We and others have measured the gene expression profiles of Y. peâ€¦</span></span>
<span><span class="co">#  10    10 [10]  Backgrouâ€¦         2        2 We and others have measured the gene expression profiles of Y. peâ€¦</span></span>
<span><span class="co">#  # â€¦ with 83 more rows</span></span></code></pre></div>
<p><code>separate_genes</code> will find microbial genes like tauD (with a capitalized 4th letter) and expand operons like <code>tauABCD</code> into four genes. <code>separate_tags</code> will find and expand locus tag ranges below.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/collapse_rows.html">collapse_rows</a></span><span class="op">(</span><span class="va">tbls</span>, na<span class="op">=</span><span class="st">"-"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="reference/separate_tags.html">separate_tags</a></span><span class="op">(</span><span class="st">"YPO"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="st">"YPO1855"</span><span class="op">)</span></span>
<span><span class="co">#  # A tibble: 3 x 5</span></span>
<span><span class="co">#    id      match        table    row text                                                                      </span></span>
<span><span class="co">#    &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;                                                                     </span></span>
<span><span class="co">#  1 YPO1855 YPO1854-1856 Tableâ€¦     5 subheading=Iron uptake or heme synthesis; Potential operon (r value)=YPO1â€¦</span></span>
<span><span class="co">#  2 YPO1855 YPO1854-1856 Tableâ€¦    21 subheading=Category C: Hypothetical; Gene ID=YPO1854-1856; Description=Puâ€¦</span></span>
<span><span class="co">#  3 YPO1855 YPO1854-YPOâ€¦ Tableâ€¦     2 Cluster=Cluster II; Genes or operons for motif discovery=hmuRSTUV, YPO068â€¦</span></span></code></pre></div>
<p>See the <a href="https://github.com/ropensci/tidypmc/blob/master/vignettes/tidypmc.md" class="external-link">vignette</a> for more details including code to parse XML documents using the <a href="https://github.com/r-lib/xml2" class="external-link">xml2</a> package. The <a href="https://github.com/ropensci/tidypmc/blob/master/vignettes/pmcftp.md" class="external-link">PMC FTP vignette</a> has details on parsing XML files at the Europe PMC <a href="https://europepmc.org/ftp/oa/" class="external-link">FTP site</a>.</p>
<div class="section level3">
<h3 id="community-guidelines">Community Guidelines<a class="anchor" aria-label="anchor" href="#community-guidelines"></a>
</h3>
<p>This project is released with a <a href="CONDUCT.html">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms. Feedback, bug reports, and feature requests are welcome <a href="https://github.com/ropensci/tidypmc/issues" class="external-link">here</a>.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=tidypmc" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/ropensci/tidypmc/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ropensci/tidypmc/issues" class="external-link">Report a bug</a></li>
</ul>
</div>



<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tidypmc</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Chris Stubben <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="r-universe">
<h2 data-toc-skip>R-universe</h2>
<ul class="list-unstyled">
<li><p><a href="https://ropensci.r-universe.dev/tidypmc" class="external-link"><img src="https://ropensci.r-universe.dev/badges/tidypmc" alt="tidypmc status badge"></a></p></li>
</ul>
</div>

<div class="software-peer-review">
<h2 data-toc-skip>Software Peer-Review</h2>
<ul class="list-unstyled">
<li><p><a href="https://github.com/ropensci/software-review/issues/290" class="external-link"><img src="https://badges.ropensci.org/290_status.svg" alt="rOpenSci peer-review"></a></p></li>
</ul>
</div>

  </aside>
</div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
